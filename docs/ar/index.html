<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>توثيق إضافة SpeakDecoratedText</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
    <a href="../en/index.html">English</a>
  <h1>توثيق إضافة SpeakDecoratedText</h1>
  <p>تعمل هذه الإضافة على تحسين إمكانية الوصول لدى قارئ الشاشة NVDA من خلال تحويل النصوص المزخرفة أو المعقدة إلى نصوص ASCII مبسطة لتسهيل القراءة والنسخ، إذ إن النصوص المزخرفة باستخدام الfancy unicode لا يقرأها برنامج الNVDA، كما أن الإضافة تتضمن ميزات خاصة لتنظيف النص العربي وإدارة سجل التحويلات.</p>

  <h2>الميزات</h2>
  <ul>
    <li>تحويل النص المزخرف إلى نص ASCII عادي ونسخه إلى الحافظة، هذه ميزة مهمة جدًا لأن النصوص المزخرفة باستخدام الFancy Unicode لا يقرأها برنامج الNVDA افتراضيًا.</li>
    <li>تنظيف النص العربي من أشياء مثل التشكيل والكاشيدة ونسخ النص المنظف إلى الحافظة.</li>
    <li>استرجاع النصوص التي حُوِّلَت سابقًا من السجل من خلال مفتاح اختصار مخصص لذلك.</li>
  </ul>

  <h2>اختصارات لوحة المفاتيح</h2>
  <ul>
    <li><span class="shortcut">NVDA + Shift + Z</span>: عند الضغط عليه مرة واحدة، ستستمع إلى النص المحدد بعد تحويله إلى حروف ASCII عادية، أما عند الضغط مرتين متتاليتين سينسخ النص المحول إلى الحافظة.</li>
    <li><span class="shortcut">NVDA + Shift + A</span>: تنظيف النص العربي المحدد ونسخه إلى الحافظة، يعمل على تحسين قابلية قراءة النصوص العربية عن طريق إزالة الأحرف الخاصة أو تحويلها إلى Unicode عربي مألوف. ينظف النص من علامات على غرار الكاشيدة والتشكيل، وإذا كانت هناك أحرف عربية مكتوبة بأحرف غير عربية مثل تلك التي تُكْتَب بالأحرف والأرقام الفارسية، فإنه بدوره يحولها إلى نصوص عربية قابلة للقراءة، إذ إنها في تلك الصورة يتعذر على البرنامج الناطق قراءتها.</li>
    <li><span class="shortcut">NVDA + Shift + H</span>: توفر سجل للنصوص التي استرجعها من قبل أو نظفها، ويتيح لك إمكانية استرجاع آخر ثلاث عمليات نسخ فقط، اضغط ضغطات متتاليات حتى تستطيع استرجاع ما تريد من السجل بحد أقصى ثلاث عمليات نسخ فقط.</li>
  </ul>

  <h2>كيف تعمل الإضافة</h2>
  <p>تستخدم الإضافة مكتبة <code>anyascii</code> في بايثون لترجمة الأحرف المزخرفة المكتوبة بأسلوب الfancy unicode أو غير ASCII إلى مكافئات ASCII، وهي لديها القدرة على التعامل مع النصوص اللاتينية فقط، أما بخصوص النصوص العربية، تستخدم دالة مخصصة للتطبيع (<code>decoratedarabic.normalize_text</code>) لتنظيف النص وتبسيطه.</p>

  <div class="note">
    <strong>ملاحظة:</strong> مكتبة <code>anyascii</code> مطلوبة لتحويل النصوص اللاتينية المكتوبة بصيغ الfancy unicode، وهي مدمجة افتراضيًا داخل مجلد الإضافة.
  </div>

  <h2>نظرة عامة على التنفيذ</h2>
  <pre><code>class GlobalPlugin(globalPluginHandler.GlobalPlugin):
  - يحتفظ بسجل قصير من النصوص المحولة (حتى 3 نصوص).
  - يستخدم فحص الوقت لاكتشاف الضغط المتتابع على الاختصارات.
  - ينسخ النص المحول أو المنظف مباشرة إلى الحافظة.
  - يوفر رسائل صوتية ينطقها الناطق لك عبر واجهة NVDA.</code></pre>

  <h2>نصائح للاستخدام</h2>
  <ul>
    <li>كي تتمكن من نسخ النص الأخير المحول، عليك بالضغط على اختصار التحويل ضغطات متتابعات خلال مدة لا تزيد عن 0.5 ثانية.</li>
    <li>اضغط على  الاختصار المخصص بسجل النسخ ضغطات متتاليات في مدة لا تزيد عن 0.5 ثانية للتنقل بين النصوص المحولة السابقة.</li>
    <li>تأكد من تحديد النص أو وضع مؤشر الreview mode على النص المستهدف قبل استخدام الاختصارات، هذه الإضافة تعمل مع النصوص الموجودة داخل صفحات الويب ومستندات مايكروسوفت وورد حيث يدعمان وضع الreview mode.</li>
  </ul>

  <h2>المكتبات المستخدمة</h2>
  <table>
    <thead>
      <tr>
        <th>المكتبة</th>
        <th>الغرض من الاستخدام</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>import globalPluginHandler</code></td>
        <td>لتسجيل الإضافة بوصفها إضافة عامة في نظام إضافات NVDA.</td>
      </tr>
      <tr>
        <td><code>import ui</code></td>
        <td>تمرير رسائل الناطق الصوتية إلى المستخدم عبر واجهة NVDA.</td>
      </tr>
      <tr>
        <td><code>import sys</code></td>
        <td>لتعديل <code>sys.path</code> لتضمين مجلد الإضافة لاستيراد المكتبات المحلية والخارجية مثل <code>anyascii</code>.</td>
      </tr>
      <tr>
        <td><code>import os</code></td>
        <td>لتحديد مسار مجلد الإضافة، مفيد للاستيراد الديناميكي أو تحديد الموارد.</td>
      </tr>
      <tr>
        <td><code>import time</code></td>
        <td>لقياس الفواصل الزمنية بين ضغطات المفاتيح للكشف عن الاستخدام السريع للاختصارات.</td>
      </tr>
      <tr>
        <td><code>import re</code></td>
        <td>لإجراء عمليات البحث والاستبدال في النص لتنظيف الرموز المزخرفة.</td>
      </tr>
      <tr>
        <td><code>import unicodedata</code></td>
        <td>لتطبيع النص وتنظيفه بإزالة التشكيلات والزخارف.</td>
      </tr>
      <tr>
        <td><code>import api</code></td>
        <td>للوصول إلى دوال API الخاصة بـ NVDA مثل <code>getReviewPosition()</code> ونسخ النص إلى الحافظة.</td>
      </tr>
      <tr>
        <td><code>from scriptHandler import script</code></td>
        <td>لتخصيص الاختصارات الخاصة بالمزية المرادة.</td>
      </tr>
    </tbody>
  </table>

  <h2>الاتصال والدعم</h2>
  <ul>
    <li>في حال  واجهتك أي مشاكل أو رغبت في المساهمة، يرجى فتح مشكلة أو طلب pull request على
      <a href="https://github.com/Abdullahashraf32/SpeakDecoratedText" target="_blank" rel="noopener noreferrer">
        <img src="myphoto.JPG" alt="My Photo"/>
        مستودع GitHub
      </a>.
    </li>
    <li>يمكنك مراسلتي عبر البريد الإلكتروني من <a href="mailto:abdullahashraf4846@gmail.com">هنا</a></li>
    <li>يمكنك التواصل معي عبر واتساب من <a href="https://wa.me/+201148467527">هنا</a></li>
    <li>في حال أردت التواصل عبر تيليجرام، يمكنك ذلك من <a href="https://t.me/abdullahashraf4846">هنا</a></li>
    <li>يمكنك زيارة قناتي على يوتيوب من <a href="https://www.youtube.com/@AbdullahAshraf-zc5dx">هنا</a></li>
  </ul>

</body>
</html>